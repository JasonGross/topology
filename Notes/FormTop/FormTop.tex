\documentclass{article}           % use "amsart" instead of "article" for AMSLaTeX format
\usepackage{geometry}                           % See geometry.pdf to learn the layout options. There are lots.
\geometry{letterpaper}                          % ... or a4paper or a5paper or ... 
%\geometry{landscape}                           % Activate for for rotated page geometry
%\usepackage[parfill]{parskip}                  % Activate to begin paragraphs with an empty line rather than an indent
\usepackage{graphicx}                           % Use pdf, png, jpg, or epsÂ§ with pdflatex; use eps in DVI mode
                                                % TeX will automatically convert eps --> pdf in pdflatex                
\usepackage{amssymb}
\usepackage{amsmath}
\usepackage[utf8]{inputenc}

\usepackage{amsthm}

\usepackage{../tex/mathpartir}

\newtheorem{lemma}{Lemma}
\newtheorem{theorem}{Theorem}
\newtheorem{corrolary}{Corrolary}

\usepackage{url}

\newcommand{\Prop}{\mathcal{P}}
\newcommand{\Type}{\mathcal{U}}
\newcommand{\R}{\mathcal{R}}
\newcommand{\QQ}{\mathcal{Q}}
\newcommand{\suchthat}{\ |\ }
\newcommand{\LEM}{\mathsf{LEM}}
\newcommand{\fun}[2]{\lambda\ {#1}.\ {#2}}
\newcommand{\nat}{\mathbb{N}}
\newcommand{\bool}{\mathbb{B}}
\newcommand{\List}[1]{\mathsf{list}\ {#1}}
\newcommand{\cat}{\ensuremath{\mathbin{+\mkern-10mu+}}}
\newcommand{\cov}{\triangleleft}
\newcommand{\down}[1]{\downarrow \! {#1}}

\title{An introduction to formal topology}
\author{Ben Sherman}
%\date{\today}                                  % Activate to display a given date or no date

\begin{document}
\maketitle

\section{Introduction}

Many mathematical concepts involve structures that are best understood not as discrete sets of points but rather as something more continuous, more akin to a connected and indivisible mass. For instance, geometry, analysis, probability, all rely on notions such as time and space, and distance and measure, which have this character. Topology studies how to make sense of these spaces.

The ``classical" theory of general topology, which defines topological spaces in terms of the basic notion of open sets, can be traced back to Felix Hausdorff's definition of neighborhood spaces in 1914. Hausdorff's definition followed a series of other attempts at axiomatizing general topology in terms of other notions such as limits, accumulation points, and metrics. Notably, all of these definitions took as given that a space should be defined as \emph{a set of points} with some additional properties.

Brouwer, in his 1913 \emph{Intuitionism and Formalism}, denies that a continuum should be identified as a set of points, declaring in his ``second act of intuitionism'' that ``the linear continuum... is not exhaustible by the interposition of new units and therefore can never be thought of as a mere collection of units.'' Moreover, Brouwer introduced a notion of choice sequences. Consider the space of sequences of boolean values, $\nat \to \bool$. Brouwer denied that every such sequence $\sigma : \nat \to \bool$ had to be necessarily determined by a law which specified the sequence in its entirety in advance. Rather, he envisioned $\sigma$ as exposing an interaction structure. Viewing $\sigma$ as a black box which we may query, at any point in time, we will only have queried it finitely many times, so we will not have constrained how it will be defined on indices which have not yet been queried. Brouwer imagined that the $\sigma$ need not be defined by a rule entirely in advance; rather, it could in fact be defined only as it was queried.

So Brouwer viewed the ``points" of the continuum as interaction structures. For instance, a real number $\mathbb{R}$ is a Cauchy choice sequence of approximating rational numbers. The user of the real number asks for an approximation with a given tolerance, and receives a response. So the user has no ability to know whether the real number is determined by a law that specified every approximating rational in advance, or whether it is a choice sequence where the finer behavior has yet to be determined.

\emph{Formal topology} defines topological spaces as interaction structures, first and foremost. Points are later defined in terms of the interaction structure. In the presence of nonconstructivity, there is little difference between formal topology and the topology descended from Hausdorff, but in a constructive setting, the theorems of formal topology are much closer to those of nonconstructive classical topology than are the constructive theorems of classical topology.

Let's explore one example of the mathematical difference between classical topology and formal topology in a constructive setting.

\section{Compactness of the Cantor space}

The Cantor space, $\nat \to \bool$, is the space of infinite sequences of Boolean values, endowed with the topology generated by the (clopen) cylinder sets $\mathcal{C} = \{ \mathsf{pre}(\ell) \suchthat \ell : \List{\bool} \}$, where
\[
\mathsf{pre}([b_1, \ldots, b_n]) = \{ \sigma : \nat \to \bool 
  \suchthat \forall i \in \{1, \ldots n \}, \sigma(i) = b_i \}.
\]

That is, the cylinder sets are the sets of all sequences beginning with a common prefix.

We define a space to be \emph{compact} if every open cover of the space has finite subcover.

The compactness of the Cantor space is undecided in constructive point-based topology, and it is in fact false in the realizability model. However, it is a theorem of formal topology that the Cantor space is compact. First, let's investigate the compactness of the Cantor space in point-based topology.

\begin{theorem}
\label{nonconstructivecompact}
Assuming the law of the excluded middle, the Cantor space is compact with the notions of point-based topology.
\end{theorem}
\begin{proof}
Suppose there is a family $\mathcal{U}$ of open sets such that no finite subset of $\mathcal{U}$ covers the Cantor space. We will prove that $\mathcal{U}$ does not cover the Cantor space by exhibiting a sequence $\sigma : \nat \to \bool$ which $\mathcal{U}$ does not cover.

For any prefix $\ell : \List{\bool}$ define the proposition $P(\ell)$ as the proposition that a finite subset of $U$ covers the cylinder $\mathsf{pre}(\ell)$. For any $\ell$, if $P(\ell \cat [\mathsf{tt}])$ and $P(\ell \cat [\mathsf{ff}])$, then $P(\ell)$, since we can combine the finite covers for the two smaller cylinders to produce a finite cover for $\ell$. Therefore, reasoning classically, if $\neg P(\ell)$, then either $\neg P(\ell \cat [\mathsf{tt}])$ or $\neg P(\ell \cat [\mathsf{ff}])$.

By the assumption that no finite subset of $\mathcal{U}$ covers the Cantor space, we have $\neg P([])$, so by the previous reasoning we can indefinitely extend the prefix $\ell$ for which there is no finite subcover of that prefix. Continuing indefinitely, this defines a sequence $\sigma$ which is not covered by any finite subcover of $\mathcal{U}$. But since points of a space split covers, i.e., if a point is covered by $\mathcal{U}$ it must lie in an open set $U$ for some $U \in \mathcal{U}$, it must be that $\sigma$ is not covered by $\mathcal{U}$, so $\mathcal{U}$ does not cover the Cantor space.
\end{proof}

However, we cannot prove the theorem without assuming nonconstructive principles such as the law of the excluded middle. See \url{http://math.andrej.com/wp-content/uploads/2006/05/kleene-tree.pdf} for a counterexample using the realizability model.

Now, we will define the Cantor space using formal topology, and exhibit a very simple constructive proof that the Cantor space is compact.

A formal topology is defined by a set $S$ of ``formal opens." $S$ is something akin to a base in point-based topology, but members of $S$ are \emph{not} subsets, as we have not even defined a space of points which members of $S$ could be subsets of. Rather, elements of $S$ are just abstract entities, but they represent in some sense the ``interface" of the topological space: they can be viewed as the possible responses from interactions. We particularly want that $S$ is made of tangible, concrete, finite elements, as we must be able to communicate these elements in a single message of communication (rather than a back-and-forth interaction, as is necessary to communicate a point in the Cantor space).

For the Cantor space, we unsurprisingly take $S = \List{\bool}$, as each $\ell : \List{\bool}$ can specify a cylinder set which comprises the base of the Cantor space. Rather than describe what these open sets mean in terms of points, we characterize the open sets by how they relate to each other. We define an operator $\cov : S \to (S \to \Prop) \to \Prop$ (where $\Prop$ is the space of all propositions). Note that the space $S \to \Prop$ of predicates over $S$ can be viewed as the subset of $S$ for which the predicate holds, and in this case, we can identify $U : S \to \Prop$ with an open cover formed entirely by opens from the base. Then $a \cov U$ intuitively means that $a$ is covered by the open cover $U$.

Using this formalism, we would say that the Cantor space is compact iff for every $U : \List{\bool} \to \Prop$ such that $[] \cov U$, there is some $V : \List{\bool} \to \Prop$ which is Kuratowski-finite such that $V \subseteq U$ and $[] \cov V$.

In the point-based topology, we would define this covering relation in terms of points. First, we connect our formal opens $S = \List{\bool}$ with the points of the Cantor space $\nat \to \bool$ by the relation $\models\  : (\nat \to \bool) \to \List{\bool} \to \Prop$ (pronounced ``lies in"), where $\sigma \models \ell$ if and only if $\sigma \in \mathsf{pre}(\ell)$. Then, we would define $a \cov U$ by
\begin{align}
\label{ptcov1}
a \cov U \triangleq \forall \sigma, \sigma \models a \to \exists b \in U, \sigma \models b.
\end{align}

Suppose we modify this definition slightly to remove the computational content of the existential:
\begin{align}
\label{ptcov2}
a \cov U \triangleq \forall \sigma, \sigma \models a \to \forall b \in U, \neg \left( \sigma \models b \right).
\end{align}

According this definition, we cannot constructively prove that the Cantor space is compact; it is with respect to the above definition that Andrej Bauer's article demonstrates that compactness of the Cantor space is false in the realizability model\footnote{I am not sure how this definition relates to the one with the existential. For the definition with the existential, we should find that the Cantor space is compact if we accept the law of the excluded middle as an axiom (and then use the classical proof) or if we accept Brouwer's continuity principle. If we accept Brouwer's continuity principle, then the function which computes the open set $b \in U$ from the sequence $\sigma : \nat \to \bool$ must only inspect finitely many elements of the input $\sigma$ (in a uniform way), so that the function must only use finitely many such open covers $b \in U$ to cover the space.}.

Instead, in formal topology, we do not connect the formal opens $S$ to a preexisting notion of points in the space. Rather, we define the covering relation inductively. For convenience, we'll define another relation $\sqsubseteq : \List{\bool} \to \List{\bool} \to \Prop$, where $a \sqsubseteq b$ iff $b$ is a prefix of $a$, or in other words, $a$ is at least as specific as $b$.

Then the cover relation is generated inductively by the following three rules:
\begin{mathpar}
\inferrule* [right=reflexivity]
  {a \in U }
  {a \cov U}

\inferrule* [right=$\le$-left]
  {a \sqsubseteq b \\ b \cov U}
  {a \cov U}
  
  \inferrule* [right=descend]
  {a \cat [\mathsf{tt}] \cov U \\ a \cat [\mathsf{ff}] \cov U}
  {a \cov U}
\end{mathpar}

One may wish to confirm that this notion of an open cover reflects what one might expect for the Cantor space. For instance, one can prove that the following laws hold:
\begin{mathpar}
\inferrule* [right=transitivity]
  {a \cov U \\ \forall b \in U, b \cov V}
  {a \cov V}
  
\inferrule* [right=monotonicity]
  {a \cov U \\ U \subseteq V}
  {a \cov V}

\inferrule* [right=$\downarrow$-right]
  {a \cov U \\ a \cov V}
  {a \cov \down{U}\  \cap  \down{V}},
\end{mathpar}
where $\down{\cdot}$ is defined as
\[
\down U = \{ a \suchthat \exists b \in U, a \sqsubseteq b \}.
\]

Here, we have a constructive proof that the Cantor space is compact. 
\begin{theorem}
Constructively, the Cantor space is compact using the definitions from formal topology.
\end{theorem}
\begin{proof}
First, we will generalize the statement, to show that for every $a : \List{\bool}$ and $U : \List{\bool} \to \Prop$ such that $a \cov U$, there is a finite subset $V \subseteq U$ such that $a \cov V$. The proof proceeds by induction on the derivation $a \cov U$.

In the base case, \emph{reflexivity}, we have that $a \in U$ directly, so we can just choose the finite subset $V = \{ a \} \subseteq U$. In the inductive case \emph{$\le$-left}, we are given some $b$ such that $a \sqsubseteq b$ and $b \cov V$ for some finite $V \subseteq U$, so by \emph{$\le$-left} we know that $a \cov V$ as well, so we also have a finite $V \subseteq U$ in this case. In the \emph{descend} case, we are given finite subsets $V_1 \subseteq U$ and $V_2 \subseteq U$ such that $a \cat [\mathsf{tt}] \cov V_1$ and $a \cat [\mathsf{ff}] \cov V_2$. By \emph{monotonicity}, we know that $a \cat [\mathsf{tt}] \cov V_1 \cup V_2$ and $a \cat [\mathsf{ff}] \cov V_1 \cup V_2$, so by \emph{descend}, we deduce that $a \cov V_1 \cup V_2$, and since each of $V_1$ and $V_2$ are Kuratowski-finite, so is their union. Thus taking $V = V_1 \cup V_2$, we have a Kuratowski-finite subset $V \subseteq U$ such that $a \cov V$.
\end{proof}

What is the difference between the definition in formal topology and the two previous definitions? In definition \ref{ptcov2}, we did not require the open cover to explain its work; it does not have to say in a positive manner how it manages to cover the space. It is for this reason that, in the realizability model, one can define a ``sparse" cover that manages to only cover the computable sequences in a way that is in essence, one at a time, so that for each finite subcover, there is a computable sequence that remains uncovered. Definition \ref{ptcov1} \emph{does} require the open cover to explain its work, in that when it is given a sequence, it must say \emph{which} open covers that sequence. If Brouwer's continuity principle holds, then in fact the decision about which open cover covers a particular sequence in a continuous manner, that is, by only looking at finitely many values of the sequence. In this case, compactness according to the definition reduces to compactness of the Cantor space in the metatheoretic sense, and so the Cantor space is compact for definition \ref{ptcov1} if Brouwer's continuity principle holds. If instead we take the law of the excluded middle, then compactness for \ref{ptcov1} simply follows from the nonconstructive proof, theorem \ref{nonconstructivecompact}. But if we do not accept either of these axioms, one may worry that the way in which the open cover ``explains" how it covers each sequence might be very funny and discontinuous, and so one could not use this proof to find a finite subset which suffices to cover the space. I imagine that there is some sort of realizability model in which compactness will fail for the same reason as it fails for definition \ref{ptcov2}.

For the definition using formal topology, we simply enforce the desired properties of an open cover by ways of the definition. With the formal topology definition, an open cover must explain how an open cover suffices to cover the space in an open-set-at-a-time manner, rather than a point-at-a-time manner. This forces its decision to be continuous, in the sense that the evidence that two sequences which are very similar are covered by an open cover must use the same open to cover those two sequences.

\section{Where are the points?}

\end{document}
